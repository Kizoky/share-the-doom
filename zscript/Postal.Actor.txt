class PostalActor : Actor 
{
	bool STD_NeverTarget, STD_NoKillLine;
	
	property NeverTarget : STD_NeverTarget;
	property NoKillLine : STD_NoKillLine;
}

class PostalInventory : Inventory { }

extend class PostalActor
{
	//Avoid targeting the following actors
	//Note: it's probably my broken checking (BlockThingsIterator) that's the issue here and not these actors below
	static const string AI_NeverTarget[] =
	{
		"PostalDoor",
		"PostalDoor_Extender",
		"PostalFire",
		"PostalLiquidGas",
		"RandomPostalFire",
		"PostalRocket",
		"PostalGrenade"
	};
	
	Actor AnnoyingFire;
}


extend class PostalInventory
{
	override void Touch (Actor toucher)
	{
		if (toucher is 'PostalDude')
		{
			let player = toucher.player;

			// If a voodoo doll touches something, pretend the real player touched it instead.
			if (player != NULL)
			{
				toucher = player.mo;
			}

			//bool localview = toucher.CheckLocalView();

			//if (!toucher.CanTouchItem(self))
			//	return;

			bool res;
			[res, toucher] = CallTryPickup(toucher);
			if (!res) return;

			// This is the only situation when a pickup flash should ever play.
			if (PickupFlash != NULL && !ShouldStay())
			{
				Spawn(PickupFlash, Pos, ALLOW_REPLACE);
			}

			if (!bQuiet)
			{
				//PrintPickupMessage(localview, PickupMessage ());

				// Special check so voodoo dolls picking up items cause the
				// real player to make noise.
				if (player != NULL)
				{
					PlayPickupSound (player.mo);
					if (!bNoScreenFlash)
					{
						player.bonuscount = BONUSADD;
					}
				}
				else
				{
					PlayPickupSound (toucher);
				}
			}							

			// [RH] Execute an attached special (if any)
			DoPickupSpecial (toucher);

			if (bCountItem)
			{
				if (player != NULL)
				{
					player.itemcount++;
				}
				level.found_items++;
			}

			if (bCountSecret)
			{
				Actor ac = player != NULL? Actor(player.mo) : toucher;
				ac.GiveSecret(true, true);
			}

			//Added by MC: Check if item taken was the roam destination of any bot
			for (int i = 0; i < MAXPLAYERS; i++)
			{
				if (players[i].Bot != NULL && self == players[i].Bot.dest)
					players[i].Bot.dest = NULL;
			}
		
		}
	}



}