#library "dudeoneliner"
#include "zcommon.acs"

global int 1:dudeline_inprogress;
global int 2:dudecheatline;
global int 3:dude_catnip_inprogress;

script 999 OPEN
{
	//Set variables to 0 or false/true initially
	dudeline_inprogress = 0;
	dudecheatline = 0;
	//acs_namedexecute("heartbeat",0,0,0,0);
	dude_catnip_inprogress = 0;
}

script 666 (void)
{
	//Dude's line isn't in progress
	if (dudeline_inprogress == 0)
	{
		//Set dudeline_inprogress to 1 so we won't hear Dude twice or more
		dudeline_inprogress = 1;
		SetActivator(0, AAPTR_PLAYER1);
		Delay(35);
		//PlaySound(0,"dudekill",1,10,false,ATTN_NONE);
		AmbientSound("dudekill",255);
		//Wait a little bit before setting the int to 0, just to ensure we won't hear Dude many times
		Delay(120);
		dudeline_inprogress = 0;
	}
}

script 1000 (void)
{
	//Again, we don't want to hear Dude twice if we cheat
	if (dudecheatline == 0)
	{
		dudecheatline = 1;
		Delay(5);
		AmbientSound("dudeline12",255);
		Delay(105);
		dudecheatline = 0;
	}
}

script 1001 (void)
{
		//A gross hack implementing "slowmo"
		if (dude_catnip_inprogress == 1)
		{
			Delay(3);
			GiveInventory("SMPowerTimeFreezerSound",1);
			Delay(5);
			TakeInventory("SMPowerTimeFreezerSound",1);
			restart;
		}
}

script 1002 (void)
{
	AmbientSound("smoke/exhale",255);
	Delay(75);
	dude_catnip_inprogress = 1;
	ACS_Execute(1001,0);
	GiveInventory("CatnipSphere",1);
	AmbientSound("dudecatnip",255);
	Delay(2100);
	dude_catnip_inprogress = 0;
	TakeInventory("CatnipPower",1);
	TakeInventory("SMPowerTimeFreezerSound",1);
}

script 1003 (void)
{
	Delay(10);
	AmbientSound("dudehurt16",255);
}

script 1004 (void)
{
	Delay(10);
	AmbientSound("dudeline27",255);
}